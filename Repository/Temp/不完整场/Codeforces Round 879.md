[Problem - D - Codeforces](https://codeforces.com/contest/1834/problem/D)

[Submission #210854134 - Codeforces](https://codeforces.com/contest/1834/submission/210854134)

我们设极差出现在X和Y区间上，则仅有在这两个区间内的值会对极差有影响。

考虑X和Y的关系，分为包含，相交和相离，贡献为图中红色部分乘2。

(图寄了不知道放哪了)

考虑线性复杂度的话，尝试对于每条线段贪心找到最大的那个解，一种可行的做法是记录全局最右左端点和最左右端点。

这样的话包含单独分类讨论，对于全部的包含情况，我们用全局最长线段减去最短线段一定是最优解。如果这两条线段相交或分离，一定是比包含更优的，于是我们并不用关心这两条线段是否是包含情况。

考虑相离和相交的情况，会发现无法统一计算，因为我们无法快速判断我们预处理的全局信息是相离还是相交，这对于我们直接计算是有影响的。

如果我们反过来，枚举每个区间，减去最小的需要减去的区间，即与其它区间重叠的最小区间，因为这个区间可以为空，于是我们可以将相离和相交一并讨论。

