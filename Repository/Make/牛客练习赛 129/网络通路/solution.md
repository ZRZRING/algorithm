记 $f_{i, S}$ 表示 $i$ 为根节点 $S$ 集合节点构成的树的最小权值，为了避免重复计算，我们钦定一棵树只有根节点可以往外连边，可以容易想到枚举 $S$ 的子集和一条边进行转移，复杂度 $\mathcal O(m 3^n)$。

考虑优化上述过程，一条边的贡献仅取决于它两侧的点数，于是我们可以在每轮转移前，预处理每条边对于每个状态的贡献，这样在转移时仅需考虑枚举根节点即可，复杂度 $\mathcal O(n 3^n + m 2^n)$。